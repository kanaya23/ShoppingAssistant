(self.miniJsonp=self.miniJsonp||[]).push([[2143],{57387:function(e,t,n){"use strict";n.r(t),n.d(t,{createPortal:function(){return a},findDOMNode:function(){return i},flushSync:function(){return s},hydrate:function(){return u},render:function(){return c},unmountComponentAtNode:function(){return o},unstable_batchedUpdates:function(){return l}});var r=window.ReactDom,a=r.createPortal,o=r.unmountComponentAtNode,c=r.render,i=r.findDOMNode,s=r.flushSync,u=r.hydrate,l=r.unstable_batchedUpdates;t.default=r},501:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var r=n(58518),a=r.default.t.bind(r.default)},63407:function(e,t,n){"use strict";n(53426),n(62850),n(62773);var r=n(29494),a="ID",o="live";(0,r.init)(a,o,"9.0.9"),window.addExternalGlobal=function(e,t){if(window.__CHAT_GLOBAL__||(window.__CHAT_GLOBAL__={}),window.__CHAT_GLOBAL__[e])throw Error("Already Added!");window.__CHAT_GLOBAL__[e]=t},n.p="https://".concat(location.host.includes("cn")?"deo.shopeesz.com":"deo.shopeemobile.com","/shopee/shopee-seller-").concat(o,"-").concat(a.toLowerCase(),"/chateasy/");var c=n(86843),i=n(57387),s=n(55036),u=n(57209),l=n(44900),d=n(53402),f=n(66633),m=n(38104),p=(n(27476),n(95767),n(98837),n(94882),n(98351),n(69193)),h=n.n(p),v=n(4942),w=n(70885),g=n(29697),_=n(96961),E=n(17744),y=n.n(E),b=n(65862),S=n.n(b),C=n(38425),O=n.n(C);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,v.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=null,I=null,k="";window.addEventListener("message",(function(e){var t;null!==(t=e.data)&&void 0!==t&&t.received&&window.clearInterval(I)}),!1);var D="https://".concat((0,r.getProjectUrl)("seller"),"/new-webchat/conversations"),A=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,r=(0,c.useRef)();(0,c.useEffect)((function(){r.current=t}),[t]),(0,c.useEffect)((function(){if(n&&n.addEventListener){var t=function(e){return r.current(e)};return n.addEventListener(e,t),function(){n.removeEventListener(n,t)}}}),[e,n])},x=n(87462),U=n.p+"1d65e1b1865219c9d05f.png",T="gEBiGsPtJy",j="yyHKyYrvkA",L="ZAV0ULHaxr",M="auAKC8Ldbh",W="OnSxgsQlfi",B=n(501).t,H=function(){return c.default.createElement("div",{className:T},c.default.createElement("div",{className:j},c.default.createElement("img",{className:L,src:U}),c.default.createElement("div",{className:M},B("common.error.hint_text")),c.default.createElement("div",{className:W,onClick:function(){window.location.reload()}},B("common.error.reload"))))},q="gLbzKNEAYF",F="sIQQtRWQPz",Z="Mj9lh6KccD",z="yLzxr6DkWa",Y="WHIaShCfot",V="QDLp_uN4bC",X=n(11876),G=n.n(X),K=n(27067),Q=n.n(K),J=(n(6059),n(94184)),$=n.n(J),ee=(n(82139),n(15671)),te=n(43144),ne=n(97326),re=n(79340),ae=n(82963),oe=n(61120),ce="hczDQaHbc3",ie="Ht2E1kwC5D",se="bAKwNuP3ME",ue=n(6691),le=n.n(ue),de=n(501).t;function fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,oe.Z)(e);if(t){var a=(0,oe.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,ae.Z)(this,n)}}var me=function(e){(0,re.Z)(n,e);var t=fe(n);function n(e){var r;return(0,ee.Z)(this,n),(r=t.call(this,e)).state={hasError:!1},r.handleReload=r.handleReload.bind((0,ne.Z)(r)),r}return(0,te.Z)(n,[{key:"componentDidCatch",value:function(e){console.log("******* error",e),this.setState({hasError:!0})}},{key:"handleReload",value:function(){window.location.reload()}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.shouldShowErrorPic,r=c.default.createElement("div",{className:ce},n&&c.default.createElement(h(),{svg:le(),className:ie}),c.default.createElement("div",null,de("common.error.load_failed"),c.default.createElement("span",{className:se,onClick:this.handleReload},de("common.error.reload"))));return this.state.hasError?r:t}}]),n}(c.default.Component),pe="EGGLy1QwiK",he="iTrdMlUViL",ve="JVrP6W1yHV",we="lm0LkZVj3H",ge="tGULtQDa1B",_e="cq5bdsI9t0",Ee="bUDk9CxOKh",ye="X6WsSex6SN",be=n(501).t,Se=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(){switch(t.name){case"profile":return c.default.createElement("div",{className:pe},c.default.createElement(Q(),{half:!0}));case"input-field":return c.default.createElement("div",{className:we},c.default.createElement(Q(),{half:!0,className:ge}),c.default.createElement("div",{className:$()(he,Ee)},c.default.createElement("div",{className:ve},c.default.createElement(Q(),{type:"square",className:_e}),c.default.createElement(Q(),{type:"square",className:_e}),c.default.createElement(Q(),{type:"square",className:_e}),c.default.createElement(Q(),{type:"square",className:_e}),c.default.createElement(Q(),{type:"square",className:_e})),c.default.createElement(Q(),{type:"square",className:_e})));case"toast":return null;default:return c.default.createElement("div",{className:ye},c.default.createElement(G(),{isInit:!0,text:be(t.loadingKey)||""}))}};return function(r){var a=n(),o="message-section"===t.name;return c.default.createElement(me,{shouldShowErrorPic:o},c.default.createElement(c.Suspense,{fallback:a},c.default.createElement(e,r)))}},Ce=Se((0,c.lazy)((function(){return Promise.all([n.e(951),n.e(2413),n.e(311),n.e(785),n.e(5623),n.e(3661),n.e(3140),n.e(7525),n.e(4489),n.e(6622),n.e(3258),n.e(7625),n.e(6845)]).then(n.t.bind(n,67625,23))})),{name:"profile"}),Oe=Se((0,c.lazy)((function(){return Promise.all([n.e(951),n.e(2413),n.e(6449),n.e(9121),n.e(3140),n.e(311),n.e(785),n.e(7346),n.e(6348),n.e(3661),n.e(6587),n.e(9725),n.e(2099),n.e(6001),n.e(3962),n.e(370),n.e(4728),n.e(6938),n.e(1222),n.e(7707),n.e(1377),n.e(5084),n.e(8846),n.e(6462),n.e(4307),n.e(3378),n.e(6308),n.e(7905),n.e(3301),n.e(6051),n.e(9039),n.e(7525),n.e(4489),n.e(6622),n.e(3258),n.e(8802),n.e(664)]).then(n.t.bind(n,39725,23))})),{name:"input-field"}),Re=Se((0,c.lazy)((function(){return Promise.all([n.e(951),n.e(2413),n.e(6449),n.e(9121),n.e(3140),n.e(785),n.e(7346),n.e(8392),n.e(295),n.e(6348),n.e(3661),n.e(6587),n.e(9725),n.e(2099),n.e(6001),n.e(3962),n.e(370),n.e(4728),n.e(6938),n.e(1222),n.e(7707),n.e(1377),n.e(5084),n.e(8846),n.e(6462),n.e(4307),n.e(3378),n.e(6308),n.e(7905),n.e(3301),n.e(6051),n.e(9039),n.e(4322),n.e(3138),n.e(7525),n.e(4489),n.e(6622),n.e(3258),n.e(7417),n.e(2626),n.e(374)]).then(n.t.bind(n,84442,23))})),{name:"message-section",loadingKey:"common.loading"}),Ne=Se((0,c.lazy)((function(){return n.e(2238).then(n.t.bind(n,65574,23))})),{name:"dropper"}),Pe=Se((0,c.lazy)((function(){return Promise.all([n.e(951),n.e(6449),n.e(5154)]).then(n.bind(n,55154))})),{name:"transfer-page"}),Ie=function(e){var t=(0,c.useState)(!1),n=(0,w.Z)(t,2),a=n[0],o=n[1],i=(0,c.useState)([]),s=(0,w.Z)(i,2),u=s[0],l=s[1],d=e.shop,f=e.currentUser,m=e.currentBuyer,p=e.isSubAccount,h=e.currentConversation,v=e.drawerMedias,g=e.setToastInformation,E=e.isSidebarList,y=e.isDriver,b=e.setAiReply,S=e.currentShopIsManagedByShopee,C=function(e){e.preventDefault(),a&&o(!1)},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fail";g({toast:{show:!0,type:t,message:e}})};return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:"".concat(q," ").concat(E?F:"")},c.default.createElement(Ce,{shop:d,currentUser:f,currentBuyer:m,isSubAccount:p,currentConversation:h,isSidebarList:E})),S?c.default.createElement(Pe,null):c.default.createElement("div",{className:"".concat(Z," ").concat(E?z:""),onDragEnter:function(e){e.preventDefault(),!a&&o(!0)}},a&&c.default.createElement(Ne,{onSuccess:function(e){var t=h.id,n=h.shop_id;l(e),(0,_.$tracker)({operation:r.TrackerOperation.ACTION_DRAG_VIDEO,section:"conversation_window",data:{conversation_id:t},shopId:n}),b({aiReply:[]})},onDragOver:function(e){return e.preventDefault()},onDragLeave:C,onDrop:C,receiverName:h.to_name,currentMediaNum:v.length,onError:O,isDriver:y}),c.default.createElement("div",{id:"messagesContainer",className:Y},c.default.createElement(Re,{currentUser:f,currentConversation:h})),c.default.createElement("div",{className:V,style:{minHeight:"".concat(r.MINI_MIN_TEXT_BOX_HEIGHT,"px")}},c.default.createElement(Oe,{shop:d,currentUser:f,currentBuyer:m,isSubAccount:p,drawerMedias:v,draggedMedias:u,currentConversation:h,handleErrorWithToast:O}))))},ke={setAiReply:m.setAiReply},De=(0,s.connect)((function(e){return{drawerMedias:(0,f.mediaListSelector)(e),shop:(0,f.currentConversationShopSelectors)(e),isDriver:(0,f.isDriverSelector)(e),currentShopIsManagedByShopee:(0,f.currentShopIsManagedByShopeeSelector)(e)}}),ke)(Ie),Ae=(n(19371),"E1p2ARHhtj"),xe="elvJjCo914",Ue="qGQqO_DNoK",Te=function(e){var t=e.children,n=e.content,r=e.placement,a=e.tipClassName,o=(0,c.useState)(!1),i=(0,w.Z)(o,2),s=i[0],u=i[1];return c.default.createElement("div",{className:Ae,onMouseEnter:function(){u(!0)},onMouseLeave:function(){u(!1)}},t,s&&c.default.createElement("div",{className:$()(xe,(0,v.Z)({},Ue,"center"===r),a)},n))},je=n(94974),Le=n.n(je),Me=n(14335),We=n.n(Me),Be=n(83540),He=n.n(Be),qe=n(9054),Fe=n.n(qe),Ze=n(2547),ze=n.n(Ze),Ye=n(92615),Ve=n.n(Ye),Xe=n(501).t;function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){(0,v.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qe=(0,s.connect)((function(e){return{currentUserId:(0,d.currentUserIdSelector)(e)}}),null)((function(e){var t=e.currentUserId,n=(0,d.usePermission)().showRecallBanner,a=(0,c.useState)(!1),o=(0,w.Z)(a,2),i=o[0],s=o[1];if((0,c.useEffect)((function(){var e=(r.LS.getItem("mini-closeMessageExpiredAlert",!0)||{})[t];s(e)}),[t]),!(!i&&n))return null;return c.default.createElement(Ve(),{isBar:!0,showIcon:!0,content:Xe("chat.message_expired_tip"),closeable:!0,onClose:function(){var e=Ke(Ke({},r.LS.getItem("mini-closeMessageExpiredAlert",!0)||{}),{},(0,v.Z)({},t,!0));r.LS.setItem("mini-closeMessageExpiredAlert",e,!0),s(!0)}})})),Je={header:"KcnW0EWoNR","logo-wrapper":"XlP40nNhhq",logoWrapper:"XlP40nNhhq",logo:"JqLTakoRNF","operator-wrapper":"gWQadxMSjy",operatorWrapper:"gWQadxMSjy","operator-item-wrapper":"XbYd8SyiP1",operatorItemWrapper:"XbYd8SyiP1","operator-item":"mHfSXeHrFb",operatorItem:"mHfSXeHrFb","show-dialog":"CSsckRs2yU mHfSXeHrFb",showDialog:"CSsckRs2yU mHfSXeHrFb","hide-dialog":"DrycptAfOA mHfSXeHrFb",hideDialog:"DrycptAfOA mHfSXeHrFb",minimize:"BIPdiTdxvZ mHfSXeHrFb",unread:"uW51vykmoV","unread-open":"beSUUorCuc",unreadOpen:"beSUUorCuc","unread-close":"Snb5SAM5_r",unreadClose:"Snb5SAM5_r"},$e=n(501).t,et={minimize:Le(),hideDialog:ze(),showDialog:Fe()},tt={updateConversationDetailStatus:d.updateConversationDetailStatus,markMessagesRequested:m.markMessagesRequested,updateChatWindowStatus:d.updateChatWindowStatus},nt=(0,s.connect)((function(e){return{totalUnreadCount:(0,d.totalUnreadConversationsCountSelector)(e)}}),tt)((function(e){var t,n=e.currentUser,a=e.totalUnreadCount,o=e.showConversationDetail,i=e.updateConversationDetailStatus,s=e.currentConversation,u=e.markMessagesRequested,l=e.updateChatWindowStatus,d=n.locale,f=["tw","cn"].includes((0,r.getServiceLocale)(d));return c.default.createElement(c.default.Fragment,null,c.default.createElement(Qe,null),c.default.createElement("div",{className:Je.header},c.default.createElement("div",{className:Je.logoWrapper},c.default.createElement(h(),{svg:f?O():y(),className:Je.logo}),!!a&&c.default.createElement("div",{className:Je.unread},c.default.createElement(h(),{svg:We(),className:Je.unreadOpen}),a,c.default.createElement(h(),{svg:He(),className:Je.unreadClose}))),(t=[],o?t.push({key:"hideDialog",tip:"header.tooltip.close_dialog",icon:"hideDialog",handler:function(e){i({showConversationDetail:!1}),(0,_.$tracker)({type:"fold_button"})}}):t.push({key:"showDialog",tip:"header.tooltip.open_dialog",icon:"showDialog",handler:function(e){var t,n,r,a,o;i({showConversationDetail:!0}),n=(t=s||{}).id,r=t.status,a=t.unread_count,o=t.latest_message_id,n&&"closed"!==r&&a>0&&u({conversationId:n,isRead:!0,latestMessageId:o}),(0,_.$tracker)({type:"unfold_button"})}}),t.push({key:"minimize",tip:"header.tooltip.minimize",icon:"minimize",handler:function(e){l({showChatWindow:!1}),(0,_.$tracker)({type:"close_button"})}}),c.default.createElement("div",{className:Je.operatorWrapper},t.map((function(e){return c.default.createElement("div",{key:e.key,className:Je.operatorItemWrapper},c.default.createElement(Te,{content:$e(e.tip)},c.default.createElement(h(),{svg:et[e.icon],className:Je[e.icon],onClick:e.handler})))}))))))})),rt=n(6286),at=n.n(rt),ot=n.p+"df95536186a5d658263c.png",ct="UvGSSkd1qQ",it="Z8RjJZsXy1",st="C8Jzw7jkTU",ut="eB3tTukA7J UvGSSkd1qQ",lt="lBcVbnezbE",dt="qqqFtuT3WF",ft="t6aX8KMaL1",mt="zMIcJ6vtsM",pt="D_bmite0fe YN8sHjfMB4",ht="m3ghEsXiiM",vt="pRa93I89hk",wt="j0EIXydtVc YN8sHjfMB4",gt=n(501).t,_t=Se((0,c.lazy)((function(){return Promise.all([n.e(951),n.e(2413),n.e(6449),n.e(9121),n.e(3140),n.e(311),n.e(8392),n.e(6348),n.e(1377),n.e(7525),n.e(4489),n.e(6622),n.e(3258),n.e(6903),n.e(8050)]).then(n.t.bind(n,72577,23))})),{name:"conversations"}),Et=Se((0,c.lazy)((function(){return Promise.all([n.e(6348),n.e(578)]).then(n.t.bind(n,91709,23))})),{name:"toast"});var yt,bt=function(e){var t=e.currentUser,n=e.isSubAccount,a=e.currentBuyer,o=e.loginSuccess,i=e.showConversationDetail,s=e.currentConversation,u=e.setToastInformation,l=e.toast,f=e.filter,m=e.conversationBeenDeleted,p=(0,d.usePermission)().showServingTab;(0,c.useEffect)((function(){(0,_.$tracker)({operation:r.TrackerOperation.VIEW,data:{tab_name_lvl_1:f.toLowerCase(),is_chatbot_user:p}})}),[f]),(0,c.useEffect)((function(){var e=(0,_.getReportManager)();null==e||e.reportShowHomePage(!1)}),[]);return c.default.createElement("div",{style:{},className:i?ct:ut},c.default.createElement(nt,{currentUser:t,showConversationDetail:i,currentConversation:s}),c.default.createElement("div",{className:it},function(){var e={currentUser:t,isSubAccount:n,currentConversation:s};if(o){return"blank_page.pcmall_title",c.default.createElement(c.default.Fragment,null,c.default.createElement(Et,{toast:l,setToastInformation:u}),c.default.createElement(_t,null),c.default.createElement("div",{className:st},s.id?c.default.createElement(De,(0,x.Z)({setToastInformation:u,currentBuyer:a},e)):c.default.createElement("div",{className:"".concat(lt," ").concat(i?"":dt)},m?c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:vt},c.default.createElement("img",{src:ot,className:mt})),c.default.createElement("div",{className:wt},gt("conversation.server_error.deleted"))):c.default.createElement(c.default.Fragment,null,c.default.createElement(h(),{svg:at(),className:ft}),c.default.createElement("div",{className:pt},gt("blank_page.pcmall_title")),c.default.createElement("div",{className:ht},gt("blank_page.buyer.tip"))))))}return c.default.createElement(H,null)}()))},St={setToastInformation:d.setToastInformation},Ct=(0,s.connect)((function(e){return{toast:(0,d.toastSelector)(e),currentUser:(0,d.currentUserSelector)(e)||{},currentBuyer:(0,f.currentBuyerSelector)(e)||{},isSubAccount:(0,d.isSubAccountSelector)(e),loginSuccess:(0,d.loginSuccessSelector)(e),currentConversation:(0,f.currentConversationSelector)(e),currentConversationId:(0,f.currentConversationIdSelector)(e),showConversationDetail:(0,d.showConversationDetailSelector)(e),filter:(0,f.filterSelector)(e),conversationBeenDeleted:(0,f.conversationBeenDeletedSelector)(e)}}),St)((function(e){return c.default.createElement(bt,e)})),Ot={"logo-wrapper":"r2v9ozyahe",logoWrapper:"r2v9ozyahe",logo:"HiSJ3Vx2WM",chat:"m3Mb2Tqdlw",counts:"v_6qeRY1jW",root:"bGX0VV9OFp",hasUnread:"nAERRUqs_I",jump:"P_7D65k6v8",jumpbar:"lCHLPQcY1b",noUnread:"VMBV0_VURc",white:"t9J4UYN3jm",red:"m_VOzMbX6j",hint:"gG0vfe2rzi",hintFooter:"xlItAfgC0G",btn:"hWgLq9FUmR","hide-btn":"Qo96nl_Au8 hWgLq9FUmR",hideBtn:"Qo96nl_Au8 hWgLq9FUmR","reply-btn":"UPQ8yWSGDT hWgLq9FUmR",replyBtn:"UPQ8yWSGDT hWgLq9FUmR",error:"EU5AP2w2pW","window-enter":"Y1NIOJgjOS",windowEnter:"Y1NIOJgjOS","half-window-enter":"AwU1Vr8Wjv",halfWindowEnter:"AwU1Vr8Wjv","window-enter-active":"YfqnOaPQow",windowEnterActive:"YfqnOaPQow","half-window-enter-active":"rbUYLP8SuB",halfWindowEnterActive:"rbUYLP8SuB","window-exit":"IHYXpW0u3u",windowExit:"IHYXpW0u3u","window-exit-active":"Uoo_1v5BH3",windowExitActive:"Uoo_1v5BH3","mall-window-exit-active":"oOmBoL2EsO Uoo_1v5BH3",mallWindowExitActive:"oOmBoL2EsO Uoo_1v5BH3","half-mall-window-exit-active":"g6klL5Stap Uoo_1v5BH3",halfMallWindowExitActive:"g6klL5Stap Uoo_1v5BH3"},Rt=n(501).t;function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){(0,v.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var It=function(e){var t,n,a=e.showEntry,o=e.currentUser,i=e.isSubAccount,s=e.loginSuccess,u=e.socketFeedback,l=e.showChatWindow,f=e.totalUnreadCount,m=e.showConversationDetail,p=e.updateChatWindowStatus,v=e.updateCurTabFocused,E=(e.isMainPage,e.hasFetchedUnread),b=e.curTabFocused,C=e.totalConversationsCount,R=e.initConversationRequested,x=(e.closeConnection,e.useNewChatEntrance),U=(0,d.usePermission)(),T=U.showCrrDue,j=U.supportSubaccountUnreplied,L=f>0,M=C.duesoonCount,W=o.locale,B=(0,c.useState)(!0),H=(0,w.Z)(B,2),q=H[0],F=H[1],Z=(0,c.useRef)(f),z=(0,c.useState)(""),Y=(0,w.Z)(z,2),V=Y[0],X=Y[1],G=(0,c.useRef)(M),K=(0,c.useState)(!1),Q=(0,w.Z)(K,2),J=Q[0],$=Q[1],ee=(0,c.useState)(!1),te=(0,w.Z)(ee,2),ne=te[0],re=te[1],ae=T&&(!i||j),oe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;(0,_.$tracker)({type:e,operation:t,data:Pt({ctx_url:window.location.href,unread_convo_cnt:f},n),page:r||"seller_center_chat"})};(0,c.useEffect)((function(){oe("chat_icon_non_animation",r.TrackerOperation.IMPRESSION,{has_unread_convo:!!f});var e=(0,_.getReportManager)();null==e||e.reportRenderHomePage(!1)}),[]);var ce=null===(t=window.__WEBCHAT_SESSION__)||void 0===t||null===(n=t.shop)||void 0===n?void 0:n.hide_for_mart_seller;(0,c.useEffect)((function(){if(a){var e=(0,_.getReportManager)();null==e||e.reportShowMinichat()}}),[a]);var ie,se,ue,le=(ie=function(e){v({focused:e})},se=100,ue=null,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ue&&(clearTimeout(ue),ue=null),ue=setTimeout((function(){ie.apply(void 0,t)}),se)});(0,c.useEffect)((function(){var e=Z.current;q&&0===e&&f>0&&E&&b&&(0,_.$tracker)({type:"chat_icon_status_change_to_with_unread_cnt",operation:r.TrackerOperation.IMPRESSION,data:{ctx_url:window.location.href},page:"seller_center_chat"}),X(f>0?"red":"white"),Z.current=f}),[f]),A("focus",(function(){return le(!0)})),A("blur",(function(){return le(!1)})),(0,c.useEffect)((function(){l&&F(!1)}),[l]),(0,c.useEffect)((function(){if(ae){var e=G.current;M>e&&(J||($(!0),oe("chat_icon_reminder",r.TrackerOperation.IMPRESSION)),re(!0)),G.current=M}}),[M]),(0,c.useEffect)((function(){ne&&(oe("chat_icon_animation",r.TrackerOperation.IMPRESSION),re(!1),yt=window.setInterval((function(){X((function(e){return"red"!==e&&e?"red":"white"}))}),500),window.setTimeout((function(){yt&&clearInterval(yt),yt=null,X(Z.current>0?"red":"white")}),3400))}),[ne]);var de=["tw","cn"].includes((0,r.getServiceLocale)(W)),fe=f>99?"99+":f,me=(0,c.useMemo)((function(){var e={enter:Ot.windowEnter,enterActive:Ot.windowEnterActive,exit:Ot.windowExit,exitActive:Ot.windowExitActive};return e.exitActive=Ot.mallWindowExitActive,m||((e=Pt(Pt({},e),{},{enter:Ot.halfWindowEnter,enterActive:Ot.halfWindowEnterActive})).exitActive=Ot.halfMallWindowExitActive),e}),[m]);if(!a)return null;var pe="\n    ".concat(Ot.root,"\n    ").concat(L?Ot.hasUnread:Ot.noUnread,"\n    ").concat(Ot[V],"\n  ");return c.default.createElement(c.default.Fragment,null,q&&!ce&&c.default.createElement("div",{className:pe},c.default.createElement("div",{className:Ot.logoWrapper,onClick:function(){void 0===window.__CLICKED_ENTRY__&&(window.__CLICKED_ENTRY__=!0,performance.mark("ENTRY_CLICKED")),void 0===window.__OPEN_ENTRY__&&(window.__OPEN_ENTRY__=!0,window.__MINICHAT_ENTRY_CLICKED__={startTime:Date.now(),fromPage:"default"});var e=!u||u.status===r.SocketToAlertType.resolved;s&&e&&oe("chat_icon",r.TrackerOperation.CLICK,{has_unread_convo:!!f,is_animation:!!yt},"minichat_page"),p({showChatWindow:!0}),R({})}},L&&c.default.createElement("div",{className:Ot.counts},fe),c.default.createElement(h(),{svg:S(),className:Ot.chat}),c.default.createElement(h(),{svg:de?O():y(),className:Ot.logo})),ae&&J&&c.default.createElement("div",{className:Ot.hint},Rt("entry.crr_reminder"),c.default.createElement("div",{className:Ot.hintFooter},c.default.createElement("div",{className:Ot.hideBtn,onClick:function(){$(!1),oe("chat_icon_reminder_mayber_later",r.TrackerOperation.CLICK)}},Rt("common.maybe_later")),c.default.createElement("div",{className:Ot.replyBtn,onClick:function(){var e,t,n,a,o,c,i,s;$(!1),oe("chat_icon_reminder_reply_now",r.TrackerOperation.CLICK),e={currentConversation:{},webChatUrl:x?D:(0,r.getWebChatUrl)(),source:"replyNow"},t=e.currentConversation,n=void 0===t?{}:t,a=e.showChatbotConversation,o=e.webChatUrl,c=e.source,i=e.chatWithType,s=void 0===i?r.ChatWithTypeEnum.Buyer:i,(0,r.getItem)("mini-sc_redirect").then((function(e){e&&e.conversationId===n.id||(e={shopId:n.shop_id,userId:n.to_id,showChatbotConversation:a,chatWithType:s});var t=N(N({},e),{},{type:"MiniChatRedirect"});c&&(t.miniSource=c),P&&!P.closed?(k!==o&&(P.location.href=o),P.focus()):(t.showConvsBeforePreload=!0,P=window.open("".concat(o),"_blank")),k=o,I&&window.clearInterval(I),I=window.setInterval((function(){try{P.postMessage(t,o)}catch(e){P=null,window.clearInterval(I)}}),1e3)}))}},Rt("common.reply_now"))))),c.default.createElement(g.Z,{unmountOnExit:!0,in:l,timeout:m?300:225,classNames:me,onEnter:null,onExited:function(){return F(!0)}},c.default.createElement(Ct,null)))},kt={updateCurTabFocused:d.updateCurTabFocused,updateChatWindowStatus:d.updateChatWindowStatus,initConversationRequested:m.initConversationRequested,closeConnection:m.closeConnectionRequested},Dt=(0,s.connect)((function(e){return{newbie:(0,d.newbieSelector)(e),showEntry:(0,d.showEntrySelector)(e),currentUser:(0,d.currentUserSelector)(e)||{},isSubAccount:(0,d.isSubAccountSelector)(e),loginSuccess:(0,d.loginSuccessSelector)(e),socketFeedback:(0,f.feedbackSelector)(e),showChatWindow:(0,d.showChatWindowSelector)(e),totalUnreadCount:(0,d.totalUnreadConversationsCountSelector)(e),showConversationDetail:(0,d.showConversationDetailSelector)(e),isMainPage:(0,d.isMainPageSelector)(e),hasFetchedUnread:(0,d.hasFetchedUnreadSelector)(e),curTabFocused:(0,d.curTabFocusedSelector)(e),totalConversationsCount:(0,f.totalConversationsCountSelector)(e),useNewChatEntrance:(0,d.useNewChatEntranceSelector)(e)}}),kt)(It);(0,_.initMDAPSdk)();var At=(0,_.getReportManager)();null==At||At.reportLoadResource();var xt=function(e){void 0===window.__OPEN_ENTRY__&&(window.__OPEN_ENTRY__=!0,window.__MINICHAT_ENTRY_CLICKED__={startTime:Date.now(),fromPage:e})},Ut=function(e,t){var n,a;l.store.getState().userReducer.loginSuccess?e():(l.store.dispatch((0,d.updateChatWindowStatus)({showChatWindow:!0})),(null===(n=window.sidebarPanelChat)||void 0===n?void 0:n.toggle)&&(null===(a=window.sidebarPanelChat)||void 0===a||a.toggle(!0,"Chat")),l.store.dispatch((0,m.initConversationRequested)({})),t&&t(r.StartChatErrorCode.Login))},Tt={create:function(e,t){var n=document.getElementById(e);if(!n){(n=document.createElement("div")).setAttribute("id",e);var r,a={position:"fixed",zIndex:"99999",right:"8px",bottom:"0"};for(r in a)n.style[r]=a[r];document.body.appendChild(n)}window.miniChatContainerId=e,function(e,t,n){i.default.render(c.default.createElement(u.zj,null,c.default.createElement(s.Provider,{store:l.store},c.default.createElement(e,{isUseNewEntryUI:n}))),document.getElementById(t))}(Dt,e,t)},startOrderChat:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Ut((function(){l.store.dispatch((0,m.redirectConversationRequested)({userId:t,shopId:e,orderId:n,entryPointType:r.entryPoint}))})),xt(r.entryPoint)},startChatWithText:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ut((function(){l.store.dispatch((0,m.redirectConversationRequested)({userId:e,message:t,entryPointType:n.entryPoint}))})),xt(n.entryPoint)},startChat:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Ut((function(){l.store.dispatch((0,m.redirectConversationRequested)({userId:t,shopId:e,productId:n,entryPointType:r.entryPoint,vSkuItem:r.vSkuItem}))})),xt(r.entryPoint)},startCommonChat:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ut((function(){l.store.dispatch((0,m.redirectConversationRequested)({userId:t,shopId:e,entryPointType:{project_detail:3501,kol_marketplace_detail:3502,kol_marketplace:3503,top_five_affiliates:3504,key_metrics:3504,free_sample_detail:3505,affiliate_homepage:3506,key_metrics_detail_product:3507,key_metrics_detail_affiliate:3508,key_metrics_view_all_affiliate:3509,handover_center_page:3510,ams_find_mcn_list:3511,ams_mcn_detail:3512,ams_mcn_campaign_detail:3513,favorite_affiliate:"favorite_affiliate"}[n.entry],callback:n.onError}))}),n.onError),xt(n.entry)},minimizeChatWindow:function(){var e,t;l.store.dispatch((0,d.updateChatWindowStatus)({showChatWindow:!1})),(null===(e=window.sidebarPanelChat)||void 0===e?void 0:e.toggle)&&(null===(t=window.sidebarPanelChat)||void 0===t||t.toggle(!1,"Chat"))},inNewBie:function(){return!1},updateLoginStatus:function(){l.store.dispatch((0,d.loginRequested)())},logout:function(){l.store.dispatch((0,d.forceLogoutRequested)())},locateMessage:function(e,t){Ut((function(){var n,r;e&&t&&(l.store.dispatch((0,d.updateChatWindowStatus)({showChatWindow:!0})),(null===(n=window.sidebarPanelChat)||void 0===n?void 0:n.toggle)&&(null===(r=window.sidebarPanelChat)||void 0===r||r.toggle(!0,"Chat")),l.store.dispatch((0,m.initConversationRequested)({})),l.store.dispatch((0,d.updateConversationDetailStatus)({showConversationDetail:!0})),l.store.dispatch((0,m.locationMessage)({msgId:e,shopId:t})))}))}};window.ChatEasy=Tt,"function"==typeof window.chatReady&&(window.__BEFORE_CHAT_READY__=Date.now(),window.chatReady()),Tt.create("shopee-mini-chat-embedded")},53426:function(){performance&&performance.mark&&performance.mark("STATIC_LOADED")},44900:function(e,t,n){"use strict";n.r(t),n.d(t,{store:function(){return x}});var r=n(38250),a=n(38104),o=n(24360),c=n(85002),i=n(8279),s=n(42982),u=(n(35666),n(19371),n(34857)),l=n(53402),d=n(66633),f=(n(27476),n(95767),n(98837),n(94882),n(98351),n(4942)),m=n(70885);n(83276),n(62850),n(62773);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=regeneratorRuntime.mark(g),w=regeneratorRuntime.mark(_);function g(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.payload.resource,n.t0="login"===t,!n.t0){n.next=5;break}return n.next=5,(0,u.put)((0,l.updateChatEntryStatus)({showEntry:!0}));case 5:return n.next=7,(0,u.put)((0,l.updateLoginSuccessStatus)({loginSuccess:!1}));case 7:return n.next=9,(0,u.put)((0,l.forceLogoutRequested)());case 9:case"end":return n.stop()}}),v)}function _(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.takeEvery)(l.handle401ErrorRequested,g);case 2:case"end":return e.stop()}}),w)}var E={blacklist:["userReducer"]},y={userReducer:l.userReducer,toastReducer:l.toastReducer,entityReducer:l.entityReducer,reportReducer:l.reportReducer,captchaVerifyReducer:l.captchaVerifyReducer,modeReducer:d.modeReducer},b=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.all)([_].concat((0,s.Z)(l.watchUserSagas),(0,s.Z)(l.watchToastSagas),(0,s.Z)(l.watchReportSagas),(0,s.Z)(l.watchHandleUrlSagas),(0,s.Z)(l.watchVerifySagas),(0,s.Z)(d.watchModeSagas)).map(u.call));case 2:case"end":return e.stop()}}),e)})),S=n(29494),C=n(96961),O=regeneratorRuntime.mark(R);function R(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(t={operation:S.TrackerOperation.IMPRESSION,type:"chat_icon",data:{ctx_url:window.location.href,has_unread_convo:!!e,unread_convo_cnt:e}}).page="minichat_page",(0,C.$tracker)(t);case 3:case"end":return n.stop()}}),O)}var N=regeneratorRuntime.mark(I),P=regeneratorRuntime.mark(k);function I(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.select)(l.permissionsSelector);case 2:e=t.sent,(e||{}).showCrrDue;case 4:case"end":return t.stop()}}),N)}function k(){var e,t,n,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,(0,u.call)(l.login);case 3:if(e=o.sent,t=e.session,n=e.params,!(r=t.user)){o.next=20;break}return o.next=10,(0,C.clearApiCache)();case 10:return o.next=12,(0,u.call)(l.handleLoginSucceededLogic,t,n);case 12:return o.next=14,(0,u.call)(I);case 14:return o.next=16,(0,u.put)((0,a.getGuideRequested)({userId:r.id,version:"9.0.9"}));case 16:return o.next=18,(0,u.put)((0,a.updateUnreadCount)({type:l.unreadCountActions.REFRESH_TOTAL_UNREAD_CONVERSATION_COUNT,source:S.UnreadSource.PRELOAD,callback:R}));case 18:return o.next=20,(0,u.spawn)(l.enterRequestedSaga);case 20:o.next=27;break;case 22:return o.prev=22,o.t0=o.catch(0),console.error("[Load Chat Failed]\n",o.t0),o.next=27,(0,u.put)((0,l.updateLoginSuccessStatus)({loginSuccess:!1}));case 27:case"end":return o.stop()}}),P,null,[[0,22]])}var D=n(15861),A=function(){var e=(0,D.Z)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=null,e.t0=t,e.next="input-field"===e.t0?4:"message-section"===e.t0?8:"profile"===e.t0?12:"socket"===e.t0?16:"conversations"===e.t0?20:"redirection-and-sync"===e.t0?24:"shop-selector"===e.t0?28:"settings"===e.t0?32:"user"===e.t0?36:"translate"===e.t0?40:44;break;case 4:return e.next=6,Promise.all([n.e(951),n.e(2413),n.e(6449),n.e(9121),n.e(3140),n.e(311),n.e(785),n.e(7346),n.e(6348),n.e(3661),n.e(6587),n.e(9725),n.e(2099),n.e(6001),n.e(3962),n.e(370),n.e(4728),n.e(6938),n.e(1222),n.e(7707),n.e(1377),n.e(5084),n.e(8846),n.e(6462),n.e(4307),n.e(3378),n.e(6308),n.e(7905),n.e(3301),n.e(6051),n.e(9039),n.e(7525),n.e(4489),n.e(6622),n.e(3258),n.e(8802),n.e(664)]).then(n.t.bind(n,39725,23));case 6:case 10:case 14:case 18:case 22:case 26:case 30:case 34:case 38:case 42:return r=e.sent,e.abrupt("break",44);case 8:return e.next=10,Promise.all([n.e(951),n.e(2413),n.e(6449),n.e(9121),n.e(3140),n.e(785),n.e(7346),n.e(8392),n.e(295),n.e(6348),n.e(3661),n.e(6587),n.e(9725),n.e(2099),n.e(6001),n.e(3962),n.e(370),n.e(4728),n.e(6938),n.e(1222),n.e(7707),n.e(1377),n.e(5084),n.e(8846),n.e(6462),n.e(4307),n.e(3378),n.e(6308),n.e(7905),n.e(3301),n.e(6051),n.e(9039),n.e(4322),n.e(3138),n.e(7525),n.e(4489),n.e(6622),n.e(3258),n.e(7417),n.e(2626),n.e(374)]).then(n.t.bind(n,84442,23));case 12:return e.next=14,Promise.all([n.e(951),n.e(2413),n.e(311),n.e(785),n.e(5623),n.e(3661),n.e(3140),n.e(7525),n.e(4489),n.e(6622),n.e(3258),n.e(7625),n.e(6845)]).then(n.t.bind(n,67625,23));case 16:return e.next=18,Promise.all([n.e(951),n.e(1377),n.e(3258),n.e(7638)]).then(n.t.bind(n,88600,23));case 20:return e.next=22,Promise.all([n.e(951),n.e(2413),n.e(6449),n.e(9121),n.e(3140),n.e(311),n.e(8392),n.e(6348),n.e(1377),n.e(7525),n.e(4489),n.e(6622),n.e(3258),n.e(6903),n.e(8050)]).then(n.t.bind(n,72577,23));case 24:return e.next=26,n.e(1324).then(n.t.bind(n,58636,23));case 28:return e.next=30,Promise.all([n.e(3661),n.e(7525),n.e(4489),n.e(6622),n.e(1446)]).then(n.t.bind(n,16366,23));case 32:return e.next=34,n.e(5571).then(n.t.bind(n,55346,23));case 36:return e.next=38,Promise.all([n.e(951),n.e(2681)]).then(n.t.bind(n,82487,23));case 40:return e.next=42,n.e(9498).then(n.t.bind(n,34233,23));case 44:return e.abrupt("return",r);case 45:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=(0,c.createStore)({advancedCombineReducers:function(e){return(0,r.combineReducers)(function(e,t){return Object.entries(t).reduce((function(t,n){var r=(0,m.Z)(n,2),a=r[0],o=r[1];return h(h({},t),{},(0,f.Z)({},a,(function(t,n){return n.type!=="".concat(l.reduxReset)||e.blacklist.includes(a)||(t=void 0),o(t,n)})))}),{})}(E,e))},enhancers:[],extensions:[{middleware:[o.dynamicMiddlewares]},(0,i.getSagaExtension)()]},{id:"root",reducerMap:y,sagas:[o.watchModuleAdded,b,k]});(0,o.addMiddleware)((0,o.dynamicModuleActionsMiddleware)({store:x,lazyImport:A,dynamicActions:a}))}},function(e){e.O(0,[2143],(function(){[951,2413,6449,9121,3140,311,785,7346,6348,3661,6587,9725,2099,6001,3962,370,4728,6938,1222,7707,1377,5084,8846,6462,4307,3378,6308,7905,3301,6051,9039,7525,4489,6622,3258,8802,664,8392,295,4322,3138,7417,2626,374,5623,7625,6845,7638,6903,8050,1324,1446,5571,2681,9498,578,2238].map(e.E)}),5);var t=function(t){return e(e.s=t)};e.O(0,[6348,2038,4444,9631,7525,4489,6622,7643],(function(){return t(63658),t(63407)}));e.O()}]);